### è®¾è®¡æ¨¡å¼


#### ç®€ä»‹

è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨çš„ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚

**Design Patterns - Elements of Reusable Object-Oriented Software**

**ä¸­æ–‡è¯‘åï¼šè®¾è®¡æ¨¡å¼ - å¯å¤ç”¨çš„é¢å‘å¯¹è±¡è½¯ä»¶å…ƒç´ **

åŸºäºä»¥ä¸‹çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™

- å¯¹æ¥å£ç¼–ç¨‹è€Œä¸æ˜¯å¯¹å®ç°ç¼–ç¨‹ã€‚
- ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ã€‚

#### ç›¸å…³é“¾æ¥

[RUNOOBå¯¹è®¾è®¡æ¨¡å¼çš„è®²è§£(java)](https://www.runoob.com/design-pattern/design-pattern-intro.html)ğŸŒŸ

[JavaScript Design Patterns: The Singleton](https://www.sitepoint.com/javascript-design-patterns-singleton/)ğŸŒŸ

 ### å•ä¾‹æ¨¡å¼

#### ç›¸å…³é“¾æ¥

[JavaScript Design Patterns: Singleton](https://robdodson.me/javascript-design-patterns-singleton/)ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

[jså•ä¾‹æ¨¡å¼](https://segmentfault.com/a/1190000012842251)ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

#### ç®€ä»‹

**Ensure a class has only one instance and provide a global point of access to it.**

è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚

è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚

**æ„å›¾ï¼š**ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚

**ä¸»è¦è§£å†³ï¼š**ä¸€ä¸ªå…¨å±€ä½¿ç”¨çš„ç±»é¢‘ç¹åœ°åˆ›å»ºä¸é”€æ¯ã€‚

**ä½•æ—¶ä½¿ç”¨ï¼š**å½“æ‚¨æƒ³æ§åˆ¶å®ä¾‹æ•°ç›®ï¼ŒèŠ‚çœç³»ç»Ÿèµ„æºçš„æ—¶å€™ã€‚

**å¦‚ä½•è§£å†³ï¼š**åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦å·²ç»æœ‰è¿™ä¸ªå•ä¾‹ï¼Œå¦‚æœæœ‰åˆ™è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºã€‚

**å…³é”®ä»£ç ï¼š**æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ã€‚

#### æ³¨æ„ç‚¹

- 1ã€å•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ã€‚
- 2ã€å•ä¾‹ç±»å¿…é¡»è‡ªå·±åˆ›å»ºè‡ªå·±çš„å”¯ä¸€å®ä¾‹ã€‚
- 3ã€å•ä¾‹ç±»å¿…é¡»ç»™æ‰€æœ‰å…¶ä»–å¯¹è±¡æä¾›è¿™ä¸€å®ä¾‹ã€‚

#### object literals or create constructor functions

```javascript
var NAMESPACE = {};

NAMESPACE.login = function() {
	// do some login shtuffs
}

NAMESPACE.logout = function() {
	// do some logout shtuffs
}

NAMESPACE.addToCart = function() {
	// blah, blah blah...
}

NAMESPACE.Widget = function(foo, bar) {
	// Some awesome widget code
}

NAMESPACE.Widget.prototype.doSomethingAwesome = function() {
	// do something awesome!!!
}

var myWidget = new NAMESPACE.Widget('hello', 'world');
```

#### Singleton with a cached static property

```javascript
function User() {
	// do we have an existing instance?
	if (typeof User.instance === 'object') {
		return User.instance;
	}
	
	// proceed as normal
	this.firstName = 'John';
	this.lastName = 'Doe';
	
	// cache
	User.instance = this;
	
	// implicit return
	// return this;
}
```

#### Singleton with a closure

[é—­åŒ…å®ç°å•ä¾‹æ¨¡å¼,æ˜é‡‘,çœ‹è§£æå›¾](https://juejin.im/post/5bb86cdbe51d450e4438042c)ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

### ç†è§£æ—¶å®¹æ˜“æ··æ·†çš„ç‚¹

1. å¯¹è±¡çš„å®ä¾‹ä¸­constructorå±æ€§åº”è¯¥æŒ‡å‘åˆ›é€ çš„å¯¹è±¡ï¼ˆå³ç”Ÿå‡ºå¥¹ä»¬çš„çˆ¶æ¯ï¼‰
2. æ„é€ å‡½æ•°thisæŒ‡å‘è°ƒç”¨è€…å¾€å¾€æ˜¯è°ƒç”¨æ„é€ å‡½æ•°çš„å®ä¾‹æœ¬èº«
3. å…¨å±€å‡½æ•°ä¸­this = window,å‡½æ•°è¢«ä½œä¸ºæŸä¸ªå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶ï¼Œthisç­‰äºé‚£ä¸ªå¯¹è±¡ã€‚åŒ¿åå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒå…·æœ‰å…¨å±€æ€§ï¼Œå…¶thisé€šå¸¸æŒ‡å‘windows

```javascript
function User() {
	// the cached instance
	var instance;

	// rewrite the constructor
	User = function() {
		return instance;
	};

	// carry over the prototype
	User.prototype = this;

	// the instance
	instance = new User();

	// reset the constructor pointer
	instance.constructor = User;

	// all the functionality
	instance.firstName = 'John';
	instance.lastName = 'Doe';

	return instance;
}
```

#### Singleton with a self executing function

å¾…è¡¥å……


#### better way but more complex

å¾…è¡¥å……

```javascript
var Singleton = (function () {
    var instance;
 
    function createInstance() {
        var object = new Object("I am the instance");
        return object;
    }
 
    return {
      //getInstance method is Singleton's gatekeeper
        getInstance: function () {
          //Lazy Load
            if (!instance) {
                instance = createInstance();
            }
            return instance;
        }
    };
})();
 
function run() {
 
    var instance1 = Singleton.getInstance();
    var instance2 = Singleton.getInstance();
 
    alert("Same instance? " + (instance1 === instance2));  
}
```

